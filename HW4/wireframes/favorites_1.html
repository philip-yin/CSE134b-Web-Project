<!DOCTYPE HTML>
<html>
 <head>
  <title>My Page</title>
  <link rel="stylesheet" href="css/styles.css">
  <meta charset="utf-8" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <script src="https://www.gstatic.com/firebasejs/3.7.0/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.6.10/firebase-storage.js"></script>
  <script src="javascript/common.js"></script>
<script>
    var cham = firebase.database().ref('Champions');
    var fav2 = firebase.database().ref('Favorites');
    
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) displayFav(user);
    });
  
    function displayFav(user){
      if(user){
         var ref1 = fav2.child(user.uid);
         if(ref1) {
           ref1.once("value")
            .then(onValue);
          }
      }
    }

    function refresh(list) {
        var lis = '<a href = "'+list[0].profile+ '" onClick = "champInfoSend(' + "'"+ list[0].name + "'" +')"' +'>'+
                   '<figure style = "margin-left: 6%; display:inline-block;">'+
                   '<img src='+list[0].image +' alt="champion" >'+
                   '<figcaption>'+list[0].name+'</figcaption></figure></a>';
        document.getElementById('fav-image').innerHTML += lis;
    }

    var onValue = function(snapshot) {
        document.getElementById('fav-image').innerHTML = '';
        var data = snapshot.val();
        for (var key in data) {
            if (data.hasOwnProperty(key)) {
                cham.child(data[key].name).on("value",function(snapshot2){
                  var data2 = snapshot2.val();
                  var list = [];
                      list.push({
                        image: data2["image"],
                        profile: data2["profile"],
                        name: data2["name"]
                      });
                      refresh(list);
                });
            }
        }
    }
	
	function champInfoSend(name){
        deleteAllCookies();
		document.cookie = name;
    }
    
    function deleteAllCookies() {
      var cookies = document.cookie.split(";");
      for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
      }
    }
</script>
 </head>
 <body>

  	<div class = topbar>
        <h1>LeagueDex</h1>
        <a href="index.html"> Home </a>
        <a href="login.html" id = "inout"> Log In</a>
        <a href="signup.html" id = "status"> Sign Up</a>
        <hr>
    </div>
    
  	<div style = "text-align: center">
      <img src="league.jpg" alt="banner">
    </div>

  	<a href="index.html" class="tablinks" style = "float:left; width:50%; text-align:center;background-color:#36366f;" onclick="">Champions</a>
  	<a href="javascript:void(0)" class="tablinks" style = "float:right; width:50%; text-align:center;background-color: #202060;" onclick="">Favorites</a>
   
    <div style = "float:right;">
    <a href="favorites_2.html" >
        <img src="list-mode.png" alt="list mode" height="39" width="39"/>
    </a>
    <a href="favorites_1.html" >
        <img src="image-mode.png" alt="image mode" height="50" width="50"/>
    </a>
    </div>
     
    <div id = "fav-image" style = "margin-top:10%; text-align:center;">
    </div>

 </body>
</html>
